<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Allenamento Giapponese</title>
  <style>
    body {
      background-color: #121212;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }

    .termine {
      margin: 20px;
    }

    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 1.1rem;
      cursor: pointer;
    }

    #progresso-container {
      margin-top: 30px;
      border-top: 1px solid #444;
      padding-top: 20px;
    }
  </style>
</head>
<body>

  <h1>Allenamento Giapponese - Capitolo 1</h1>

  <div class="termine" data-parola="nihon">
    <p>Traduci: Giappone</p>
    <button onclick="rispondi('nihon', true)">nihon ✅</button>
    <button onclick="rispondi('nihon', false)">arigatou ❌</button>
  </div>

  <div class="termine" data-parola="arigatou">
    <p>Traduci: Grazie</p>
    <button onclick="rispondi('arigatou', true)">arigatou ✅</button>
    <button onclick="rispondi('arigatou', false)">neko ❌</button>
  </div>

  <div class="termine" data-parola="neko">
    <p>Traduci: Gatto</p>
    <button onclick="rispondi('neko', true)">neko ✅</button>
    <button onclick="rispondi('neko', false)">inu ❌</button>
  </div>

  <div id="progresso-container"></div>

  <script>
    // Aggiorna punteggio per parola
    function aggiornaProgresso(capitolo, parola, punteggio) {
      const salvataggio = JSON.parse(localStorage.getItem("progresso")) || {};

      if (!salvataggio[capitolo]) {
        salvataggio[capitolo] = {};
      }

      salvataggio[capitolo][parola] = punteggio;

      const valori = Object.entries(salvataggio[capitolo])
        .filter(([key]) => key !== "score")
        .map(([_, val]) => val);

      const media = valori.length > 0
        ? Math.round((valori.reduce((a, b) => a + b, 0) / valori.length) * 10 * 100) / 100
        : 0;

      salvataggio[capitolo].score = media;

      localStorage.setItem("progresso", JSON.stringify(salvataggio));
      mostraProgressoHTML();
    }

    function getProgresso() {
      return JSON.parse(localStorage.getItem("progresso")) || {};
    }

    function mostraProgressoHTML() {
      const progresso = getProgresso();
      const container = document.getElementById("progresso-container");
      container.innerHTML = "<h2>Progresso</h2>";

      for (const [capitolo, dati] of Object.entries(progresso)) {
        const score = dati.score || 0;
        const div = document.createElement("div");
        div.innerHTML = `<strong>${capitolo}</strong>: ${score}/10`;
        container.appendChild(div);
      }
    }

    function rispondi(parola, corretta) {
      const punteggio = corretta ? 1 : 0;
      aggiornaProgresso("capitolo1", parola, punteggio);
      alert(corretta ? "Corretto! +1 punto" : "Sbagliato! 0 punti");
    }

    // Carica i progressi al caricamento della pagina
    window.onload = mostraProgressoHTML;
  </script>

</body>
</html>
